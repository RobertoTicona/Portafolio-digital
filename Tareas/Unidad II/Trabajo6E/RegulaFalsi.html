<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>M√©todo de Regula Falsi ‚Äì Programaci√≥n Num√©rica</title>
  <link rel="stylesheet" href="../../../css/tareas.css">
</head>
<body>

  <!-- Encabezado -->
  <header>
    <h1>Unidad II ‚Äì M√©todo de Regula Falsi</h1>
    <p>Actividad del curso de Programaci√≥n Num√©rica</p>
  </header>

  <!-- Descripci√≥n -->
  <div class="section">
    <h2>Descripci√≥n</h2>
    <p style="text-align: justify;">
      El <strong>m√©todo de Regula Falsi</strong>, tambi√©n conocido como <em>m√©todo de la Falsa Posici√≥n</em>, es una t√©cnica num√©rica utilizada 
      para encontrar ra√≠ces reales de ecuaciones no lineales de la forma <em>f(x) = 0</em>. 
      Se basa en el mismo principio del m√©todo de Bisecci√≥n: la existencia de una ra√≠z dentro de un intervalo 
      <em>[a, b]</em> donde <em>f(a)</em> y <em>f(b)</em> tienen signos opuestos, es decir, <em>f(a)f(b) &lt; 0</em>.
    </p>

    <p style="text-align: justify;">
      A diferencia de la Bisecci√≥n, el m√©todo de Regula Falsi no toma el punto medio del intervalo, sino que aproxima la ra√≠z 
      mediante la intersecci√≥n de la recta secante que pasa por los puntos <em>(a, f(a))</em> y <em>(b, f(b))</em> con el eje <em>x</em>.  
      El valor aproximado de la ra√≠z en cada iteraci√≥n se calcula mediante la f√≥rmula:
    </p>

    <pre><code>c = b - (f(b) * (a - b)) / (f(a) - f(b))</code></pre>

    <p style="text-align: justify;">
      El proceso se repite reemplazando uno de los extremos del intervalo seg√∫n el signo de <em>f(c)</em>, 
      de modo que siempre se mantenga la condici√≥n de cambio de signo.  
      El m√©todo converge m√°s r√°pido que la Bisecci√≥n, especialmente cuando la funci√≥n se comporta de forma aproximadamente 
      lineal cerca de la ra√≠z.
    </p>

    <h3>Importancia de la visualizaci√≥n previa</h3>
    <p style="text-align: justify;">
      Antes de aplicar el m√©todo, es recomendable graficar la funci√≥n <em>f(x)</em> en el intervalo de estudio.  
      Esta representaci√≥n permite verificar visualmente la existencia de una ra√≠z (es decir, el cruce con el eje <em>x</em>) 
      y seleccionar adecuadamente los valores iniciales <em>a</em> y <em>b</em> donde la funci√≥n cambia de signo.  
      Una elecci√≥n incorrecta del intervalo puede hacer que el m√©todo falle o no converja hacia la ra√≠z deseada.
    </p>

    <h3>Restricciones y limitaciones</h3>
    <ul>
      <li>Requiere que <em>f(a)</em> y <em>f(b)</em> tengan signos opuestos (<em>f(a)f(b) &lt; 0</em>).</li>
      <li>Si la funci√≥n tiene una pendiente muy diferente en los extremos del intervalo, la convergencia puede volverse lenta.</li>
      <li>No garantiza la convergencia si la funci√≥n no es continua o no cambia de signo en el intervalo.</li>
    </ul>
  </div>

  <!-- Aplicaci√≥n -->
  <div class="section">
    <h2>Aplicaci√≥n del m√©todo en Python</h2>
    <p style="text-align: justify;">
      Se desarroll√≥ un programa en <strong>Python</strong> que permite al usuario ingresar una funci√≥n <em>f(x)</em>, graficarla en un intervalo definido
      y aplicar el m√©todo de Regula Falsi si as√≠ lo desea.
    </p>

    <p style="text-align: justify;">
      El programa realiza iteraciones hasta que se cumpla un criterio de tolerancia, mostrando en cada paso los valores de 
      <em>a</em>, <em>b</em>, <em>c</em>, <em>f(c)</em> y el error estimado.
    </p>

    <h3>Entradas del programa</h3>
    <ul>
      <li>Una cadena de texto que representa la funci√≥n matem√°tica <em>f(x)</em>.</li>
      <li>Los valores iniciales <em>a</em> y <em>b</em> que delimitan el intervalo de b√∫squeda.</li>
      <li>El intervalo para graficar la funci√≥n.</li>
    </ul>

    <p>Ejemplo de funci√≥n:</p>
    <pre><code>f(x) = x**3 - x - 1</code></pre>

    <h3>Salidas del programa</h3>
    <ul>
      <li>Gr√°fica de la funci√≥n <em>f(x)</em> en el intervalo ingresado.</li>
      <li>La ra√≠z aproximada encontrada.</li>
      <li>N√∫mero de iteraciones realizadas hasta cumplir la tolerancia.</li>
    </ul>

    <h3>Restricciones</h3>
    <ul>
      <li>La funci√≥n debe ser continua en el intervalo <em>[a, b]</em>.</li>
      <li>Debe cumplirse la condici√≥n de cambio de signo <em>f(a)f(b) &lt; 0</em>.</li>
    </ul>
  </div>

  <!-- C√≥digo -->
  <div class="section">
    <h2>C√≥digo en Python</h2>
    <pre><code>
      import numpy as np
      import matplotlib.pyplot as plt

      # === 1. Ingreso de la funci√≥n ===
      print("=== M√âTODO DE REGULA FALSI (FALSA POSICI√ìN) ===")
      func_str = input("Ingrese la funci√≥n f(x): ")  # Ejemplo: x**3 - x - 1

      # Definici√≥n de la funci√≥n
      def f(x):
          return eval(func_str, {"np": np, "x": x})

      # === 2. Graficar la funci√≥n ===
      xmin = float(input("Ingrese el valor m√≠nimo de x: "))
      xmax = float(input("Ingrese el valor m√°ximo de x: "))

      x = np.linspace(xmin, xmax, 400)
      y = f(x)

      plt.figure(figsize=(8, 5))
      plt.plot(x, y, label=f"f(x) = {func_str}", color='blue')
      plt.axhline(0, color='black', linestyle='--')
      plt.axvline(0, color='black', linestyle='--')
      plt.title("Gr√°fico de la funci√≥n ingresada")
      plt.xlabel("x")
      plt.ylabel("f(x)")
      plt.legend()
      plt.grid(True)
      plt.show()

      # === 3. Pregunta si desea aplicar el m√©todo de Regula Falsi ===
      op = input("¬øDesea aplicar el m√©todo de Regula Falsi? (s/n): ").lower()

      if op == "s":
          # === 4. Ingreso de los extremos del intervalo ===
          a = float(input("Ingrese el valor de a (extremo izquierdo): "))
          b = float(input("Ingrese el valor de b (extremo derecho): "))

          # Comprobaci√≥n del cambio de signo
          if f(a) * f(b) > 0:
              print("‚ö†Ô∏è La funci√≥n no cambia de signo en el intervalo. No se puede aplicar el m√©todo.")
          else:
              tol = 1e-6
              max_iter = 100

              print("\nIteraci√≥n |      a      |      b      |      c      |    f(c)     |   Error")
              print("-----------------------------------------------------------------------")

              c_old = a
              for i in range(1, max_iter + 1):
                  # F√≥rmula de Regula Falsi
                  c = b - (f(b) * (a - b)) / (f(a) - f(b))
                  error = abs(c - c_old)
                  c_old = c

                  print(f"{i:9d} | {a:10.6f} | {b:10.6f} | {c:10.6f} | {f(c):10.6f} | {error:10.6f}")

                  if abs(f(c)) < tol or error < tol:
                      print(f"\n‚úÖ Ra√≠z aproximada encontrada: {c:.6f}")
                      print(f"Iteraciones realizadas: {i}")
                      break

                  # Actualizaci√≥n de intervalos
                  if f(a) * f(c) < 0:
                      b = c
                  else:
                      a = c
              else:
                  print("\n‚ö†Ô∏è No se alcanz√≥ la convergencia despu√©s de", max_iter, "iteraciones.")
      else:
          print("No se aplic√≥ el m√©todo de Regula Falsi.")
    </code></pre>
  </div>

  <!-- Enlaces -->
  <div class="section">
    <div class="links">
      <a href="PN_U2_Trabajo_6_M√©todo_de_Regula_Falsi.pdf" target="_blank">üìÑ Ver PDF</a>
      <a href="RegulaFalsi.py" target="_blank">üêç Descargar C√≥digo</a>
      <a href="../../../unidad2.html">‚¨ÖÔ∏è Volver a Actividades de la Unidad 2</a>
    </div>
  </div>

</body>
</html>
